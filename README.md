# blogspot

Full-featured CMS including blog, wiki, discussion, etc. Cloud native application that powered by SpringBoot.

- Based on SpringBoot 3.x
- Search support
- OAuth2 integration (Weibo, QQ, Facebook, etc.)
- SEO support
- REST API
- Customized CSS with UIkit2

### Environment

- JDK 17
- MySQL 5.7
- Redis 5/6 with RediSearch 2

### Run with Docker

Run MySQL, RediSearch in background:

```
cd dev
docker-compose up -d
```

Run blogspot application:

```
docker run -d -p 2019:2019 --rm \
  --env-file /path/to/env-file \
  -v /var/log/blogspot:/var/log/blogspot \
  --name blogspot devansh1305/blogspot:1.4
```

### Build

```
$ mvn -DskipTests=true clean package
```

Or check [build.sh](build.sh).

### Initialize database

DDL and test data are generated by [SchemaBuilder.java](src/main/java/com/blogspot/SchemaBuilder.java).

Create schema:

```
$ mysql -u root -p < dev/sql/ddl.sql
```

NOTE: re-run this SQL file will remove all existing data.

### Run

```
java -jar blogspot.jar
```

Visit [http://localhost:2019](http://localhost:2019) for demo.

### Search

Search is auto-enabled if RediSearch 2.x is detected. [How to install RediSearch in Redis](https://redis.io/docs/stack/search/quick_start/).

### Config

Please check [application.yml](src/main/resources/application.yml) for environment variables.

### Deploy

blogspot is deployed by Docker. Images can be pulled from [DockerHub](https://hub.docker.com/repository/docker/devansh1305/blogspot).

```
                        ┌─────────────────────────────────────────┐
                        │                   VPC                   │
                        │         ┌───────────┐                   │
                        │         │  Docker   │     ┌────────────┐│
        https        ┌──┴──┐      │┌─────────┐│     │  AWS:RDS   ││
◀───────────────────▶│     │ http ││ AWS:ECS ││◀───▶│   MySQL    ││
 https ┌─────┐ https │ ELB │◀────▶│└─────────┘│     └────────────┘│
◀─────▶│ CDN │◀─────▶│     │      │┌─────────┐│     ┌────────────┐│
       └─────┘       └──┬──┘      ││ AWS:ECS ││◀───▶│ElasticCache││
                        │         │└─────────┘│     │   Redis    ││
                        │         └───────────┘     └────────────┘│
                        └─────────────────────────────────────────┘
```
